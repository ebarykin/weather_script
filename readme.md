## Описание

Это скрипт Python для мониторинга и экспорта погодных данных, получаемых через API Open-Meteo. 
Данные сохраняются в базу данных и могут быть экспортированы в Excel по команде пользователя.

## Основные компоненты

### 1. Получение данных
- **Функция**: `get_weather_data()`
- **Описание**: Использует API Open-Meteo для получения текущих погодных данных.

### 2. Сохранение данных
- **Функция**: `save_weather_data(data)`
- **Описание**: Сохраняет полученные данные в базу данных.

### 3. Экспорт данных
- **Функция**: `export_to_excel()`
- **Описание**: Экспортирует последние 10 записей из базы данных в Excel файл.

### 4. Асинхронная обработка
- **Функция**: `fetch_weather_periodically()`
- **Описание**: Асинхронно получает погодные данные каждые 180 секунд и сохраняет их.
- **Функция**: `handle_export_command()`
- **Описание**: Асинхронно обрабатывает команду пользователя для экспорта данных в Excel.

### Требования
- Python 3.7+
- Библиотеки: `openmeteo_requests`, `pandas`, `sqlalchemy`, `aioconsole`

## Пример экспортируемых данных
- **Пример файла**: [weather_2024-10-11_11-09-35.xlsx](weather_2024-10-11_11-09-35.xlsx)
![Скриншот экспортированных данных](/screen.jpg)